---
title: "Introduction to dplyr"
author: "Reiko Okamoto"
date: "`r Sys.Date()`"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## ðŸ‘‹Welcome to the tidyverse

#### ***What is the tidyverse?***

The [tidyverse](https://tidyverse.tidyverse.org/) is a collection of R packages designed for data science. Arguably, two of the most popular packages in the tidyverse are [dplyr](https://dplyr.tidyverse.org/) for data manipulation and [ggplot2](https://ggplot2.tidyverse.org/) for data visualization. These are also the packages that we are covering today!

***Why learn it?***

The skills you gain are not just limited to R. The concepts, like filtering data and creating plots, are applicable to other languages like SQL and Python. This makes it easier to pick up other tools and languages later. Additionally, the tidyverse is in tune with open science practices, helping you create analyses that are more accessible, transparent, and reproducible.

***Keep in mind...***

There's no expectation for you to memorize everything. Even experienced programmers don't have every function memorized - they're constantly googling things! My goal today is to help you get comfortable with, and hopefully interested in, using the tidyverse for data analysis.

## ðŸ§Meet the Palmer penguins

![](imgs/penguins.png){width="500"}

We'll use the **penguins** data set from the [palmerpenguins](https://allisonhorst.github.io/palmerpenguins/) package. It contains measurements for adult penguins observed in the islands in the Palmer Archipelago off the Antarctic Peninsula. The data were collected and made available by Dr. Kristen Gorman and the Palmer Station Long Term Ecological Research (LTER) Program. This data set is great for learning because it's small enough to be manageable for beginners but contains a range of different types of data and features.

ðŸ’»Load the necessary packages:

```{r}
library(tidyverse)
library(palmerpenguins)
```

ðŸ’»Open the data set documentation:

```{r}
?penguins
```

![](imgs/culmen_depth.png){width="500"}

## 1ï¸âƒ£Get a glimpse of your data: glimpse()

ðŸ’»Inspect the data using the [glimpse()](https://dplyr.tidyverse.org/reference/glimpse.html) function.

```{r}
glimpse(penguins)
```

-   *How many rows?*

-   *How many columns?*

-   *How many data types?*

-   *Are there any missing values?*

## 2ï¸âƒ£Keep or drop columns: select()

Sometimes, you only need to work with a few specific columns instead of the entire data. The [select()](https://dplyr.tidyverse.org/reference/select.html) function makes it easy to do just that. It allows you to focus on the columns you need and ignore the rest, making your code cleaner.

ðŸ’»Select one column by name:

```{r}
select(penguins, species)
```

ðŸ’»Select two columns by name:

```{r}
select(penguins, species, island)
select(penguins, c(species, island))
```

ðŸ’»Select all columns except certain ones:

```{r}
select(penguins, -species, -island)
```

ðŸ’»Select columns that start with "bill":

```{r}
select(penguins, starts_with("bill"))
```

Similar functions like ends_with() and contains() are also available to select columns based on the ending or presence of specific characters.

ðŸ’»Select numeric variables:

```{r}
select(penguins, where(is.numeric))
```

## 3ï¸âƒ£Keep rows that match a condition: filter()

Filtering data is a common task in data analysis. Use the [filter()](https://dplyr.tidyverse.org/reference/filter.html) function to focus on specific observations.

ðŸ’»Show only the penguins of the Gentoo species:

```{r}
filter(penguins, species == "Gentoo")
```

ðŸ’»Find all Adelie penguins that are also on Torgersen Island:

```{r}
filter(penguins, species == "Adelie", island == "Torgersen")
```

The comma acts as an AND operator, meaning both conditions must be true for a row to be included.

ðŸ’»Find all penguins that either Adelie or Gentoo:

```{r}
filter(penguins, species == "Adelie" | species == "Gentoo")
```

The vertical bar acts as an OR operator, meaning a row is returned if any of the conditions are true.

#### ðŸ“Exercise 1

1.  Select the "sex" and "year" columns from the data.

2.  Filter the data to show only the rows where "flipper_length_mm" is greater than 200.

3.  Filter the data to find all penguins that are either on Biscoe Island or Torgersen Island.

    ```{r}

    ```

## 4ï¸âƒ£Pipes

ðŸ’»Filter the data to only include Adelie penguins, and then keep only the columns that start with "bill":

```{r}
select(filter(penguins, species == "Adelie"), starts_with("bill"))
```

This works, but it can get difficult to read, especially as your code grows more complex. The nested functions force you to read the code inside-out, making it less intuitive

ðŸ’»Use the pipe to do the same thing in a more streamlined way:

```{r}
penguins |> 
  filter(species == "Adelie") |> 
  select(starts_with("bill"))
```

The pipe allows us to pass the output of one function directly to the next. This approach makes your code easier to read because the operations flow left to right, top to bottom.

Keyboard shortcuts for the pipe:

-   Windows: Ctrl + Shift + M

-   Mac: Cmd + Shift + M

#### ðŸ“Exercise 2

Filter the data include only female penguins with "bill_length_mm" less than or equal to 40, and then select the "species" and "bill_length_mm" columns.

```{r}
penguins |> 
  filter(sex == "female", bill_length_mm <= 40) |> 
  select(species, bill_length_mm)
```

## 
